```{r}
bench::mark(
  ij_cross = datasets$players %>% 
    dplyr::select(player_id, first_visit_date) %>%
    dplyr::inner_join(date_grid, by = character()) %>% 
    arrange(player_id),
  crossing = datasets$players %>% 
    dplyr::select(player_id, first_visit_date) %>%
    tidyr::crossing(date_grid) %>% 
    arrange(player_id),
  check = FALSE # ignore attribute diffs
)

set.seed(1234)
x = rnorm(1000)
x[x>2] = NA

library(tidyverse)
library(data.table)

bench::mark(
  ifelse   = ifelse(is.na(x), 0, x),
  if_else  = if_else(is.na(x), 0, x),
  coalesce = coalesce(x, 0), 
  fcoalesce = fcoalesce(x, 0), 
  relative = TRUE
)

set.seed(1234)
x0 = rnorm(1000)
x = rep(TRUE, length(x0))
x[x0>2] = NA

bench::mark(
  ifelse    = ifelse(is.na(x), FALSE, x),
  ifelse2   = ifelse(is.na(x), FALSE, TRUE),
  if_else   = if_else(is.na(x), FALSE, x),
  if_else2  = if_else(is.na(x), FALSE, TRUE),
  coalesce  = coalesce(x, FALSE), 
  fcoalesce = fcoalesce(x, FALSE), 
  relative  = TRUE
)

```

